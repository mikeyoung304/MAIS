# P3: Missing Contract Registration in ts-rest Router

## Priority: P3 Nice-to-have
## Status: complete
## Feature: DATE Booking Flow
## Category: Architecture

## Issue

The `createDateBooking` endpoint is defined in the contract but NOT registered in the ts-rest router.

**File:** `server/src/routes/index.ts:604-612`

**Current State:**
- Contract exists at line 1372 in `api.v1.ts`
- Express router mounted at line 610 in `index.ts`
- But ts-rest router (lines 153-407) doesn't implement the contract endpoint

## Impact

- TypeScript client auto-generated by ts-rest won't include `createDateBooking` method
- Client code uses manual `fetch()` instead of type-safe client
- Loses type safety benefits of contract-first design

**Client Workaround (DateBookingWizard.tsx:127-128):**
```typescript
// Make direct fetch call to the new endpoint since ts-rest may not have picked it up yet
const response = await fetch(`${baseUrl}/v1/public/bookings/date`, { ... });
```

## Recommendation

Either:
1. **Implement contract in ts-rest router** (recommended):
   ```typescript
   // In ts-rest router
   createDateBooking: async ({ body, req }) => {
     // ... implementation
     return { status: 200, body: { checkoutUrl } };
   },
   ```

2. **Remove contract and keep Express-only** (document why)

## Files to Update

1. `server/src/routes/index.ts` - Add to ts-rest router
2. `client/src/features/storefront/DateBookingWizard.tsx` - Use typed API client



## Work Log

### 2025-12-21 - Approved for Work
**By:** Claude Triage System
**Actions:**
- Issue approved during triage session (bulk approval)
- Status changed from pending â†’ ready
- Ready to be picked up and worked on

## Review Reference
- Architecture Review Finding P3 (Missing Contract Registration)
